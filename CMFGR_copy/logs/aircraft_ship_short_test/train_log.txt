2025-12-11 18:52:51,138 transreid INFO: Saving model in the path :logs/aircraft_ship_short_test
2025-12-11 18:52:51,138 transreid INFO: Namespace(config_file='configs/aircraft_transoss.yml', opts=['MODEL.PRETRAIN_PATH', 'weights/HOSS_TransOSS.pth', 'MODEL.PRETRAIN_CHOICE', 'imagenet', 'MODEL.DIST_TRAIN', 'False', 'SOLVER.MAX_EPOCHS', '5', 'SOLVER.EVAL_PERIOD', '1', 'SOLVER.IMS_PER_BATCH', '16', 'DATALOADER.NUM_WORKERS', '2', 'OUTPUT_DIR', 'logs/aircraft_ship_short_test'], local_rank=0)
2025-12-11 18:52:51,138 transreid INFO: Loaded configuration file configs/aircraft_transoss.yml
2025-12-11 18:52:51,139 transreid INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  PRETRAIN_PATH: 'weights/vit_base_p16_224-4e355ebd.pth' # 确保你有这个权重文件
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'  # 分类任务建议开启 Label Smooth
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  DEVICE_ID: ('0')
  TRANSFORMER_TYPE: 'vit_base_patch16_224_TransOSS'
  STRIDE_SIZE: [16, 16]
  MIE: True       # 开启模态嵌入 (RGB vs SAR)
  MIE_COE: 3.0
  SSE: False      # <--- 关闭船只尺寸嵌入，非常重要
  PAIR: False

INPUT:
  SIZE_TRAIN: [128, 256] # 调整为 (width, height) 以兼容 RandomCrop
  SIZE_TEST: [128, 256]
  PROB: 0.5
  RE_PROB: 0.5
  PADDING: 10
  PIXEL_MEAN: [0.5, 0.5, 0.5] # 根据你的数据分布调整，或者保留 ImageNet 均值
  PIXEL_STD: [0.5, 0.5, 0.5]

DATASETS:
  NAMES: ('AircraftShip')  # <--- 使用新注册的数据集名
  ROOT_DIR: ('./data')     # 数据存放根目录

DATALOADER:
  SAMPLER: 'softmax_triplet'
  NUM_INSTANCE: 4
  NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 120
  BASE_LR: 0.005
  IMS_PER_BATCH: 64
  # ... 其他参数保持默认或根据显存调整 ...

TEST:
  EVAL: True
  IMS_PER_BATCH: 128
  RE_RANKING: False
  FEAT_NORM: 'yes'

OUTPUT_DIR: './logs/aircraft_ship_transoss'
2025-12-11 18:52:51,139 transreid INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 2
  SAMPLER: softmax_triplet
DATASETS:
  NAMES: AircraftShip
  ROOT_DIR: ./data
INPUT:
  PADDING: 10
  PIXEL_MEAN: [0.5, 0.5, 0.5]
  PIXEL_STD: [0.5, 0.5, 0.5]
  PROB: 0.5
  RE_PROB: 0.5
  SIZE_TEST: [128, 256]
  SIZE_TRAIN: [128, 256]
MODEL:
  ATT_DROP_RATE: 0.0
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 1.0
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  METRIC_LOSS_TYPE: triplet
  MIE: True
  MIE_COE: 3.0
  NAME: transformer
  NECK: bnneck
  NO_MARGIN: True
  PAIR: False
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: weights/HOSS_TransOSS.pth
  SSE: False
  STRIDE_SIZE: [16, 16]
  TRANSFORMER_TYPE: vit_base_patch16_224_TransOSS
  TRIPLET_LOSS_WEIGHT: 1.0
OUTPUT_DIR: logs/aircraft_ship_short_test
SOLVER:
  BASE_LR: 0.005
  BIAS_LR_FACTOR: 1
  CENTER_LOSS_WEIGHT: 0.0005
  CENTER_LR: 0.5
  CHECKPOINT_PERIOD: 10
  COSINE_MARGIN: 0.5
  COSINE_SCALE: 30
  EVAL_PERIOD: 1
  GAMMA: 0.1
  IMS_PER_BATCH: 16
  LARGE_FC_LR: False
  LOG_PERIOD: 100
  MARGIN: 0.3
  MAX_EPOCHS: 5
  MOMENTUM: 0.9
  OPTIMIZER_NAME: SGD
  SEED: 1234
  STEPS: (40, 70)
  WARMUP_EPOCHS: 5
  WARMUP_FACTOR: 0.01
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  IMS_PER_BATCH: 128
  NECK_FEAT: after
  RE_RANKING: False
  WEIGHT: 
2025-12-11 18:52:54,264 transreid.train INFO: start training
2025-12-11 18:53:02,674 transreid.train INFO: Epoch[1] Iteration[100/2268] Loss: 3.490, Acc: 0.316, Base Lr: 1.04e-03
2025-12-11 18:53:09,608 transreid.train INFO: Epoch[1] Iteration[200/2268] Loss: 3.140, Acc: 0.338, Base Lr: 1.04e-03
2025-12-11 18:53:16,461 transreid.train INFO: Epoch[1] Iteration[300/2268] Loss: 2.971, Acc: 0.365, Base Lr: 1.04e-03
2025-12-11 18:53:23,543 transreid.train INFO: Epoch[1] Iteration[400/2268] Loss: 2.877, Acc: 0.382, Base Lr: 1.04e-03
2025-12-11 18:53:30,714 transreid.train INFO: Epoch[1] Iteration[500/2268] Loss: 2.805, Acc: 0.396, Base Lr: 1.04e-03
2025-12-11 18:53:37,819 transreid.train INFO: Epoch[1] Iteration[600/2268] Loss: 2.755, Acc: 0.407, Base Lr: 1.04e-03
2025-12-11 18:53:44,925 transreid.train INFO: Epoch[1] Iteration[700/2268] Loss: 2.709, Acc: 0.418, Base Lr: 1.04e-03
2025-12-11 18:53:52,507 transreid.train INFO: Epoch[1] Iteration[800/2268] Loss: 2.672, Acc: 0.426, Base Lr: 1.04e-03
2025-12-11 18:54:00,008 transreid.train INFO: Epoch[1] Iteration[900/2268] Loss: 2.645, Acc: 0.432, Base Lr: 1.04e-03
2025-12-11 18:54:07,301 transreid.train INFO: Epoch[1] Iteration[1000/2268] Loss: 2.621, Acc: 0.437, Base Lr: 1.04e-03
2025-12-11 18:54:14,513 transreid.train INFO: Epoch[1] Iteration[1100/2268] Loss: 2.589, Acc: 0.449, Base Lr: 1.04e-03
2025-12-11 18:54:21,913 transreid.train INFO: Epoch[1] Iteration[1200/2268] Loss: 2.558, Acc: 0.462, Base Lr: 1.04e-03
2025-12-11 18:54:29,421 transreid.train INFO: Epoch[1] Iteration[1300/2268] Loss: 2.528, Acc: 0.474, Base Lr: 1.04e-03
2025-12-11 18:54:36,770 transreid.train INFO: Epoch[1] Iteration[1400/2268] Loss: 2.497, Acc: 0.487, Base Lr: 1.04e-03
2025-12-11 18:54:44,478 transreid.train INFO: Epoch[1] Iteration[1500/2268] Loss: 2.466, Acc: 0.499, Base Lr: 1.04e-03
2025-12-11 18:54:51,404 transreid.train INFO: Epoch[1] Iteration[1600/2268] Loss: 2.425, Acc: 0.516, Base Lr: 1.04e-03
2025-12-11 18:54:58,496 transreid.train INFO: Epoch[1] Iteration[1700/2268] Loss: 2.385, Acc: 0.531, Base Lr: 1.04e-03
2025-12-11 18:55:02,986 transreid.train INFO: Epoch 1 done. Time per batch: 0.073[s] Speed: 219.3[samples/s]
2025-12-11 18:55:41,593 transreid.train INFO: Validation Results - Epoch: 1
2025-12-11 18:55:41,593 transreid.train INFO: mAP: 39.6%
2025-12-11 18:55:41,593 transreid.train INFO: CMC curve, Rank-1  :83.8%
2025-12-11 18:55:41,593 transreid.train INFO: CMC curve, Rank-5  :94.8%
2025-12-11 18:55:41,593 transreid.train INFO: CMC curve, Rank-10 :97.2%
2025-12-11 18:55:49,042 transreid.train INFO: Epoch[2] Iteration[100/2268] Loss: 2.542, Acc: 0.437, Base Lr: 2.03e-03
2025-12-11 18:55:56,205 transreid.train INFO: Epoch[2] Iteration[200/2268] Loss: 2.489, Acc: 0.460, Base Lr: 2.03e-03
2025-12-11 18:56:03,441 transreid.train INFO: Epoch[2] Iteration[300/2268] Loss: 2.453, Acc: 0.481, Base Lr: 2.03e-03
2025-12-11 18:56:10,701 transreid.train INFO: Epoch[2] Iteration[400/2268] Loss: 2.445, Acc: 0.488, Base Lr: 2.03e-03
2025-12-11 18:56:17,866 transreid.train INFO: Epoch[2] Iteration[500/2268] Loss: 2.442, Acc: 0.490, Base Lr: 2.03e-03
2025-12-11 18:56:25,169 transreid.train INFO: Epoch[2] Iteration[600/2268] Loss: 2.434, Acc: 0.492, Base Lr: 2.03e-03
2025-12-11 18:56:32,356 transreid.train INFO: Epoch[2] Iteration[700/2268] Loss: 2.434, Acc: 0.491, Base Lr: 2.03e-03
2025-12-11 18:56:39,466 transreid.train INFO: Epoch[2] Iteration[800/2268] Loss: 2.432, Acc: 0.494, Base Lr: 2.03e-03
2025-12-11 18:56:46,737 transreid.train INFO: Epoch[2] Iteration[900/2268] Loss: 2.421, Acc: 0.500, Base Lr: 2.03e-03
2025-12-11 18:56:53,906 transreid.train INFO: Epoch[2] Iteration[1000/2268] Loss: 2.408, Acc: 0.505, Base Lr: 2.03e-03
2025-12-11 18:57:00,934 transreid.train INFO: Epoch[2] Iteration[1100/2268] Loss: 2.396, Acc: 0.510, Base Lr: 2.03e-03
2025-12-11 18:57:08,298 transreid.train INFO: Epoch[2] Iteration[1200/2268] Loss: 2.375, Acc: 0.520, Base Lr: 2.03e-03
2025-12-11 18:57:15,428 transreid.train INFO: Epoch[2] Iteration[1300/2268] Loss: 2.351, Acc: 0.531, Base Lr: 2.03e-03
2025-12-11 18:57:22,732 transreid.train INFO: Epoch[2] Iteration[1400/2268] Loss: 2.330, Acc: 0.540, Base Lr: 2.03e-03
2025-12-11 18:57:29,966 transreid.train INFO: Epoch[2] Iteration[1500/2268] Loss: 2.305, Acc: 0.553, Base Lr: 2.03e-03
2025-12-11 18:57:37,083 transreid.train INFO: Epoch[2] Iteration[1600/2268] Loss: 2.273, Acc: 0.566, Base Lr: 2.03e-03
2025-12-11 18:57:44,015 transreid.train INFO: Epoch[2] Iteration[1700/2268] Loss: 2.245, Acc: 0.577, Base Lr: 2.03e-03
2025-12-11 18:57:47,900 transreid.train INFO: Epoch 2 done. Time per batch: 0.072[s] Speed: 221.7[samples/s]
2025-12-11 18:58:24,430 transreid.train INFO: Validation Results - Epoch: 2
2025-12-11 18:58:24,430 transreid.train INFO: mAP: 43.1%
2025-12-11 18:58:24,430 transreid.train INFO: CMC curve, Rank-1  :82.9%
2025-12-11 18:58:24,430 transreid.train INFO: CMC curve, Rank-5  :94.9%
2025-12-11 18:58:24,430 transreid.train INFO: CMC curve, Rank-10 :97.5%
2025-12-11 18:58:31,920 transreid.train INFO: Epoch[3] Iteration[100/2268] Loss: 2.509, Acc: 0.466, Base Lr: 3.02e-03
2025-12-11 18:58:39,632 transreid.train INFO: Epoch[3] Iteration[200/2268] Loss: 2.452, Acc: 0.493, Base Lr: 3.02e-03
2025-12-11 18:58:47,056 transreid.train INFO: Epoch[3] Iteration[300/2268] Loss: 2.445, Acc: 0.501, Base Lr: 3.02e-03
2025-12-11 18:58:54,271 transreid.train INFO: Epoch[3] Iteration[400/2268] Loss: 2.438, Acc: 0.501, Base Lr: 3.02e-03
2025-12-11 18:59:01,878 transreid.train INFO: Epoch[3] Iteration[500/2268] Loss: 2.422, Acc: 0.510, Base Lr: 3.02e-03
2025-12-11 18:59:09,154 transreid.train INFO: Epoch[3] Iteration[600/2268] Loss: 2.418, Acc: 0.511, Base Lr: 3.02e-03
2025-12-11 18:59:16,357 transreid.train INFO: Epoch[3] Iteration[700/2268] Loss: 2.420, Acc: 0.509, Base Lr: 3.02e-03
2025-12-11 18:59:23,751 transreid.train INFO: Epoch[3] Iteration[800/2268] Loss: 2.414, Acc: 0.513, Base Lr: 3.02e-03
2025-12-11 18:59:32,677 transreid.train INFO: Epoch[3] Iteration[900/2268] Loss: 2.414, Acc: 0.515, Base Lr: 3.02e-03
2025-12-11 18:59:41,852 transreid.train INFO: Epoch[3] Iteration[1000/2268] Loss: 2.409, Acc: 0.516, Base Lr: 3.02e-03
2025-12-11 18:59:51,043 transreid.train INFO: Epoch[3] Iteration[1100/2268] Loss: 2.397, Acc: 0.521, Base Lr: 3.02e-03
2025-12-11 18:59:58,749 transreid.train INFO: Epoch[3] Iteration[1200/2268] Loss: 2.380, Acc: 0.530, Base Lr: 3.02e-03
2025-12-11 19:00:05,317 transreid.train INFO: Epoch[3] Iteration[1300/2268] Loss: 2.359, Acc: 0.538, Base Lr: 3.02e-03
2025-12-11 19:00:12,073 transreid.train INFO: Epoch[3] Iteration[1400/2268] Loss: 2.342, Acc: 0.546, Base Lr: 3.02e-03
2025-12-11 19:00:19,217 transreid.train INFO: Epoch[3] Iteration[1500/2268] Loss: 2.319, Acc: 0.557, Base Lr: 3.02e-03
2025-12-11 19:00:26,281 transreid.train INFO: Epoch[3] Iteration[1600/2268] Loss: 2.292, Acc: 0.569, Base Lr: 3.02e-03
2025-12-11 19:00:33,434 transreid.train INFO: Epoch[3] Iteration[1700/2268] Loss: 2.261, Acc: 0.582, Base Lr: 3.02e-03
2025-12-11 19:00:38,165 transreid.train INFO: Epoch 3 done. Time per batch: 0.076[s] Speed: 211.2[samples/s]
2025-12-11 19:01:16,727 transreid.train INFO: Validation Results - Epoch: 3
2025-12-11 19:01:16,727 transreid.train INFO: mAP: 44.2%
2025-12-11 19:01:16,727 transreid.train INFO: CMC curve, Rank-1  :83.2%
2025-12-11 19:01:16,727 transreid.train INFO: CMC curve, Rank-5  :95.0%
2025-12-11 19:01:16,727 transreid.train INFO: CMC curve, Rank-10 :97.4%
2025-12-11 19:01:23,811 transreid.train INFO: Epoch[4] Iteration[100/2268] Loss: 2.585, Acc: 0.449, Base Lr: 4.01e-03
2025-12-11 19:01:30,780 transreid.train INFO: Epoch[4] Iteration[200/2268] Loss: 2.489, Acc: 0.482, Base Lr: 4.01e-03
2025-12-11 19:01:37,950 transreid.train INFO: Epoch[4] Iteration[300/2268] Loss: 2.464, Acc: 0.493, Base Lr: 4.01e-03
2025-12-11 19:01:45,082 transreid.train INFO: Epoch[4] Iteration[400/2268] Loss: 2.461, Acc: 0.494, Base Lr: 4.01e-03
2025-12-11 19:01:52,273 transreid.train INFO: Epoch[4] Iteration[500/2268] Loss: 2.454, Acc: 0.503, Base Lr: 4.01e-03
2025-12-11 19:01:59,353 transreid.train INFO: Epoch[4] Iteration[600/2268] Loss: 2.456, Acc: 0.503, Base Lr: 4.01e-03
2025-12-11 19:02:06,321 transreid.train INFO: Epoch[4] Iteration[700/2268] Loss: 2.458, Acc: 0.502, Base Lr: 4.01e-03
2025-12-11 19:02:13,345 transreid.train INFO: Epoch[4] Iteration[800/2268] Loss: 2.455, Acc: 0.502, Base Lr: 4.01e-03
2025-12-11 19:02:20,572 transreid.train INFO: Epoch[4] Iteration[900/2268] Loss: 2.455, Acc: 0.502, Base Lr: 4.01e-03
2025-12-11 19:02:28,038 transreid.train INFO: Epoch[4] Iteration[1000/2268] Loss: 2.446, Acc: 0.504, Base Lr: 4.01e-03
2025-12-11 19:02:35,105 transreid.train INFO: Epoch[4] Iteration[1100/2268] Loss: 2.424, Acc: 0.514, Base Lr: 4.01e-03
2025-12-11 19:02:42,324 transreid.train INFO: Epoch[4] Iteration[1200/2268] Loss: 2.404, Acc: 0.523, Base Lr: 4.01e-03
2025-12-11 19:02:49,450 transreid.train INFO: Epoch[4] Iteration[1300/2268] Loss: 2.380, Acc: 0.533, Base Lr: 4.01e-03
2025-12-11 19:02:56,873 transreid.train INFO: Epoch[4] Iteration[1400/2268] Loss: 2.360, Acc: 0.543, Base Lr: 4.01e-03
2025-12-11 19:03:04,386 transreid.train INFO: Epoch[4] Iteration[1500/2268] Loss: 2.343, Acc: 0.551, Base Lr: 4.01e-03
2025-12-11 19:03:11,762 transreid.train INFO: Epoch[4] Iteration[1600/2268] Loss: 2.311, Acc: 0.564, Base Lr: 4.01e-03
2025-12-11 19:03:18,946 transreid.train INFO: Epoch[4] Iteration[1700/2268] Loss: 2.283, Acc: 0.576, Base Lr: 4.01e-03
2025-12-11 19:03:21,864 transreid.train INFO: Epoch 4 done. Time per batch: 0.072[s] Speed: 222.7[samples/s]
2025-12-11 19:03:57,958 transreid.train INFO: Validation Results - Epoch: 4
2025-12-11 19:03:57,958 transreid.train INFO: mAP: 44.2%
2025-12-11 19:03:57,958 transreid.train INFO: CMC curve, Rank-1  :82.2%
2025-12-11 19:03:57,959 transreid.train INFO: CMC curve, Rank-5  :94.4%
2025-12-11 19:03:57,959 transreid.train INFO: CMC curve, Rank-10 :97.2%
2025-12-11 19:04:05,075 transreid.train INFO: Epoch[5] Iteration[100/2268] Loss: 3.691, Acc: 0.245, Base Lr: 1.00e-05
2025-12-11 19:04:12,103 transreid.train INFO: Epoch[5] Iteration[200/2268] Loss: 3.659, Acc: 0.243, Base Lr: 1.00e-05
2025-12-11 19:04:19,626 transreid.train INFO: Epoch[5] Iteration[300/2268] Loss: 3.604, Acc: 0.238, Base Lr: 1.00e-05
2025-12-11 19:04:26,861 transreid.train INFO: Epoch[5] Iteration[400/2268] Loss: 3.522, Acc: 0.246, Base Lr: 1.00e-05
2025-12-11 19:04:34,177 transreid.train INFO: Epoch[5] Iteration[500/2268] Loss: 3.472, Acc: 0.248, Base Lr: 1.00e-05
2025-12-11 19:04:41,440 transreid.train INFO: Epoch[5] Iteration[600/2268] Loss: 3.415, Acc: 0.253, Base Lr: 1.00e-05
2025-12-11 19:04:48,693 transreid.train INFO: Epoch[5] Iteration[700/2268] Loss: 3.364, Acc: 0.258, Base Lr: 1.00e-05
2025-12-11 19:04:55,855 transreid.train INFO: Epoch[5] Iteration[800/2268] Loss: 3.300, Acc: 0.270, Base Lr: 1.00e-05
2025-12-11 19:05:03,311 transreid.train INFO: Epoch[5] Iteration[900/2268] Loss: 3.247, Acc: 0.280, Base Lr: 1.00e-05
2025-12-11 19:05:10,581 transreid.train INFO: Epoch[5] Iteration[1000/2268] Loss: 3.203, Acc: 0.286, Base Lr: 1.00e-05
2025-12-11 19:05:17,622 transreid.train INFO: Epoch[5] Iteration[1100/2268] Loss: 3.150, Acc: 0.299, Base Lr: 1.00e-05
2025-12-11 19:05:24,863 transreid.train INFO: Epoch[5] Iteration[1200/2268] Loss: 3.089, Acc: 0.315, Base Lr: 1.00e-05
2025-12-11 19:05:32,136 transreid.train INFO: Epoch[5] Iteration[1300/2268] Loss: 3.035, Acc: 0.329, Base Lr: 1.00e-05
2025-12-11 19:05:39,263 transreid.train INFO: Epoch[5] Iteration[1400/2268] Loss: 2.984, Acc: 0.344, Base Lr: 1.00e-05
2025-12-11 19:05:46,539 transreid.train INFO: Epoch[5] Iteration[1500/2268] Loss: 2.925, Acc: 0.364, Base Lr: 1.00e-05
2025-12-11 19:05:53,779 transreid.train INFO: Epoch[5] Iteration[1600/2268] Loss: 2.857, Acc: 0.390, Base Lr: 1.00e-05
2025-12-11 19:06:01,124 transreid.train INFO: Epoch[5] Iteration[1700/2268] Loss: 2.797, Acc: 0.412, Base Lr: 1.00e-05
2025-12-11 19:06:07,055 transreid.train INFO: Epoch 5 done. Time per batch: 0.073[s] Speed: 220.5[samples/s]
2025-12-11 19:06:43,397 transreid.train INFO: Validation Results - Epoch: 5
2025-12-11 19:06:43,398 transreid.train INFO: mAP: 45.2%
2025-12-11 19:06:43,398 transreid.train INFO: CMC curve, Rank-1  :82.6%
2025-12-11 19:06:43,398 transreid.train INFO: CMC curve, Rank-5  :94.4%
2025-12-11 19:06:43,398 transreid.train INFO: CMC curve, Rank-10 :96.9%
